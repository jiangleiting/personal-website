<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="这是一个记录技术探索和生活感悟的个人网站，分享Web开发、编程技术和个人成长经验。">
    <meta name="keywords" content="个人网站,技术博客,Web开发,编程,全栈开发">
    <meta name="author" content="蒋雷霆">
    <meta name="robots" content="index,follow">
    <meta property="og:title" content="我的个人网站">
    <meta property="og:description" content="这是一个记录技术探索和生活感悟的个人网站">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jiangleiting.github.io/personal-website/">
    
    <!-- 性能优化：预加载关键资源 -->
    <link rel="preload" href="./assets/css/style.css" as="style">
    <link rel="preload" href="./assets/js/main.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js" as="script">
    
    <!-- PWA支持 -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#4a9eff">
    
    <link rel="icon" href="./assets/images/favicon.ico" type="image/x-icon">
    <title>我的个人网站 - 技术探索与生活感悟</title>
    <link rel="stylesheet" href="./assets/css/style.css">
    
    <!-- 添加Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- 延迟加载非关键CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" media="print" onload="this.media='all'">
    
    <!-- 添加Service Worker注册 -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VWXV2Q40XH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VWXV2Q40XH');
    </script>
    
    <!-- 百度统计 -->
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</head>
<body>
    <div id="particles-js"></div>
    
    <!-- 添加返回顶部按钮 -->
    <button id="backToTop" class="back-to-top" aria-label="返回顶部">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- 添加阅读进度条 -->
    <div class="progress-bar" id="readingProgress"></div>
    
    <header class="header">
        <nav class="nav-container">
            <a href="./index.html" class="logo">我的网站</a>
            <div class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="search-container">
                <input type="text" class="search-input" placeholder="搜索文章...">
            </div>
            <ul class="nav-menu">
                <li><a href="./index.html">首页</a></li>
                <li><a href="./pages/blog.html">博客</a></li>
                <li><a href="./pages/about.html">关于</a></li>
                <li><a href="./pages/contact.html">联系</a></li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <div class="container">
            <section class="hero">
                <h1>欢迎来到我的个人网站</h1>
                <p>这里记录我的技术探索和生活感悟</p>
            </section>

            <section class="blog-posts">
                <article class="post-card">
                    <h3>文章标题 1</h3>
                    <div class="post-meta">发布于 2024-05-15</div>
                    <p>这是一篇关于技术探索的文章...</p>
                    <div class="post-footer">
                        <a href="#" class="read-more-btn">阅读更多</a>
                        <div class="share-buttons">
                            <button class="share-btn" onclick="shareToWeibo(this)" data-title="文章标题 1" data-url="window.location.href">
                                <i class="fab fa-weibo"></i>
                            </button>
                            <button class="share-btn" onclick="shareToTwitter(this)" data-title="文章标题 1" data-url="window.location.href">
                                <i class="fab fa-twitter"></i>
                            </button>
                            <button class="share-btn" onclick="showQRCode(this)" data-url="window.location.href">
                                <i class="fas fa-qrcode"></i>
                            </button>
                        </div>
                    </div>
                </article>

                <article class="post-card">
                    <h3>文章标题 2</h3>
                    <div class="post-meta">发布于 2024-05-14</div>
                    <p>分享一些有趣的编程经验...</p>
                    <a href="#" class="read-more-btn">阅读更多</a>
                </article>

                <article class="post-card">
                    <h3>文章标题 3</h3>
                    <div class="post-meta">发布于 2024-05-13</div>
                    <p>记录一次难忘的开发经历...</p>
                    <a href="#" class="read-more-btn">阅读更多</a>
                </article>
            </section>
            
            <!-- 添加评论区 -->
            <section class="comments-section">
                <h2>评论</h2>
                <div id="gitalk-container"></div>
            </section>

            <!-- QR Code Modal -->
            <div id="qrModal" class="modal">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h3>扫描二维码分享</h3>
                    <div id="qrcode"></div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2024 我的个人网站. All rights reserved.</p>
        </div>
    </footer>
    <script>
        // 评论区配置
        const gitalk = new Gitalk({
            clientID: 'Ov23lik6kBl3aJWI9Noi', // GitHub OAuth App Client ID
            clientSecret: '09e7d9ee48ccc50b40cdd9a597e8e171a93b29e8', // GitHub OAuth App Client Secret
            repo: 'personal-website',      // 存储评论的仓库名
            owner: 'jiangleiting',         // 您的GitHub用户名
            admin: ['jiangleiting'],       // 管理员用户名
            id: location.pathname,         // 页面唯一标识
            distractionFreeMode: false     // 无干扰模式
        });
        gitalk.render('gitalk-container');

        // 分享到微博
        function shareToWeibo(button) {
            const title = button.getAttribute('data-title');
            const url = button.getAttribute('data-url');
            const shareUrl = `http://service.weibo.com/share/share.php?url=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}`;
            window.open(shareUrl, '_blank', 'width=700,height=500');
        }

        // 分享到Twitter
        function shareToTwitter(button) {
            const title = button.getAttribute('data-title');
            const url = button.getAttribute('data-url');
            const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}`;
            window.open(shareUrl, '_blank', 'width=700,height=500');
        }

        // 显示二维码
        function showQRCode(button) {
            const url = button.getAttribute('data-url');
            const modal = document.getElementById('qrModal');
            const qrcodeDiv = document.getElementById('qrcode');
            
            // 清除已有的二维码
            qrcodeDiv.innerHTML = '';
            
            // 生成新的二维码
            new QRCode(qrcodeDiv, {
                text: url,
                width: 200,
                height: 200
            });
            
            modal.style.display = 'block';
        }

        // 关闭二维码模态框
        document.querySelector('.close-modal').onclick = function() {
            document.getElementById('qrModal').style.display = 'none';
        }

        // 点击模态框外部关闭
        window.onclick = function(event) {
            const modal = document.getElementById('qrModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // 添加自定义事件跟踪
        function trackEvent(category, action, label) {
            if (window.gtag) {
                gtag('event', action, {
                    'event_category': category,
                    'event_label': label
                });
            }
            if (window._hmt) {
                _hmt.push(['_trackEvent', category, action, label]);
            }
        }

        // 示例：跟踪文章阅读
        document.querySelectorAll('.read-more-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const title = this.closest('.post-card').querySelector('h3').textContent;
                trackEvent('Article', 'Read', title);
            });
        });

        // 示例：跟踪分享行为
        document.querySelectorAll('.share-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const platform = this.querySelector('i').className.includes('weibo') ? 'Weibo' : 'Twitter';
                trackEvent('Share', 'Click', platform);
            });
        });
    </script>
    
    <!-- 优化脚本加载顺序 -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js" defer></script>
    <script src="./assets/js/particles-config.js" defer></script>
    <script src="./assets/js/main.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode.js/qrcode.min.js" defer></script>
</body>
</html>